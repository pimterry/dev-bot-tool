# DevBot Deploy [![Build Status](https://travis-ci.org/pimterry/dev-bot-tool.png)](https://travis-ci.org/pimterry/dev-bot-tool)

**[DevBot](https://github.com/pimterry/dev-bot) is a framework to build chat-bot-based developer tooling.**

This is a command line tool to manage your DevBots, so you can run them locally, host them for free (typically) on AWS Lambda, and generally get things done.

Take a look at [DevBot](https://github.com/pimterry/dev-bot) for more info on how to build bots themselves. For the rest of this readme, I'm going to assume you're totally on that, you've got at least the start of a bot ready and waiting.

## Getting Started

First up, get a bot ready, and then install the DevBot tool:

```javascript
npm install --save-dev dev-bot-tool
```

To run your bot locally,

To actually deploy your bot, you'll need an AWS account, and your AWS credentials in the environment. For most projects you'll want to create a .env file in the root of your repo (**remember to .gitignore it!**) and `source .env` before your commands, but to quickly test this you can just run:

```bash
export AWS_ACCESS_KEY_ID=AAAAAAAAAAAAAA
export AWS_SECRET_ACCESS_KEY=BBBBBBBBBBBBBBBBBBBBBBBBBBBBB

dev-bot aws-deploy myBotName my-bot.js
```

Note that the above will only work with `dev-bot` in your path. You can install it globally, but typically instead I install it locally in my bots, and run the above from NPM scripts (which automatically include `./node_modules/bin`, where the DevBot CLI tool lives, in their path). Check out JokeBot's [package.json](https://github.com/jokebot/jokebot/blob/master/package.json) for an example of this all put together.

## Commands

`aws-deploy [botName] [entryPoint]`

Deploys a given bot to AWS. At a minimum it needs a name for the bot, and the script defining its interface. This bundles up the codebase, with its production dependencies and some DevBot wrapper code, uploads it to AWS Lambda, and starts it. 'Your codebase' is the current directory by default, or can be specified explicitly with `--root=[directory]`.

If a bot with the same name exists, it is replaced. If you don't specify a role with `--role=[roleName]`, or the role you do specify doesn't exist, one is automatically created with minimal default permissions. If you need more permissions, edit the role (`autogenerated-dev-bot-role`, by default) in the AWS console. By default, bots are created in `eu-west-1`, but you can specify a different region with `--region=[regionName]` when deploying.

You can also set environmental variables that will be available to your bot when running. To do so, create a dotenv format (KEY=VALUE, newline separated) file listing these values, and specify it when deploying with `--env [filename]`. In most cases this will be because you've got secrets you don't want to hardcode in your codebase, so they stay secret. Don't forget to .gitignore it!
